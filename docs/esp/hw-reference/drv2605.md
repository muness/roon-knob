DRV2605 Haptic Driver – App‑Facing Notes

Overview
- TI DRV2605/DRV2605L is a single‑channel haptic driver for ERM (eccentric rotating mass) and LRA (linear resonant actuator) motors.
- I2C control with an on‑chip effect library (waveform sequencer) and optional real‑time playback.
- Ideal for short UI haptics (clicks, bumps) on encoder turns or button presses.

Electrical
- Supply: 2.0–5.5 V (check your board’s rail; keep good local bypass at the device and motor).
- Output: H‑bridge drive to a single actuator (ERM or LRA). Connect the motor directly to the OUT+ / OUT− pins on the module/IC.
- Typical I2C address: 0x5A (7‑bit). The demo in: ~/Downloads/…/03_DRV2605_Test sets 0x5A via EXAMPLE_DRV2605_ADDR.

I2C & Timing
- Bus: 100–400 kHz.
- GO bit latches a playback/calibration operation; wait until it clears before starting another.
- The device can enter standby; clear standby (Mode register) before issuing effects.

Actuator Setup (ERM vs LRA)
- Select actuator type in the control/feedback registers (ERM default on many modules).
- Provide motor parameters via Rated Voltage and Overdrive Clamp registers. If unknown, run Auto‑Calibration:
  1) Write motor voltage limits (conservative values if unsure).
  2) Select Auto‑Cal mode and set GO=1.
  3) Wait for GO to return 0; read status for success/fail.
  4) Store calibration results if you persist settings.
- For LRA, calibration also measures resonance; use the built‑in LRA library when playing effects.

Basic Playback Flow (Internal Library)
1. Ensure device is in Internal Trigger mode (not standby).
2. Select a library (ERM or LRA appropriate).
3. Program Waveform Sequence slots (slot0..slotN) with effect IDs; terminate with 0x00.
4. Set GO=1. The driver executes the sequence; GO returns to 0 when complete.
5. Optional: monitor the Status register (diagnostics, OCP).

Real‑Time Playback (RTP)
- For custom feel without library IDs, choose RTP mode and write amplitude to the RTP register at ~200–300 Hz while GO is set. Useful for simple “buzz while pressed” effects.

Effect IDs (Common Clicks)
- DRV2605 ships with standardized effect IDs (documentation names vary by library). Common choices for UI:
  - “Strong Click” (short, crisp tactile)
  - “Sharp Click” / “Soft Bump” (lighter variations)
  - Double/Triple Click sequences for confirmation actions
- Choose IDs from the ERM or LRA library that match your actuator; test and pick the best feel.

App Recommendations (Roon Knob)
- Provide short “click” per volume step; a slightly stronger pulse on play/pause; optional longer pulse on zone switch.
- Initialize once at boot:
  - Bring device out of standby; run auto‑cal on first boot (persist results in NVS), otherwise load stored settings.
  - Select library per actuator type (ERM/LRA).
- Keep a tiny non‑blocking haptics queue so UI events don’t overlap pulses (drop or coalesce fast repeats).

Gotchas
- Don’t start a new effect while GO=1; either queue or ignore until it returns to 0.
- Rated/Clamp voltage too high can over‑drive the motor; start conservative and calibrate.
- If effects feel weak or buzzy on LRA, switch libraries and re‑run calibration; resonance matters.
- Ensure I2C pull‑ups and decoupling near the driver; motor current transients can glitch the bus.

References
- TI DRV2605/DRV2605L datasheet (register map, effect library tables, auto‑cal details).
- Local demo: ESP-IDF 03_DRV2605_Test (I2C on GPIO 11/12, address 0x5A).

